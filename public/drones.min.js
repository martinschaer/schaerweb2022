(()=>{console.log("Hello drones.ts");var n,e=[],t=new Set,s=async()=>{const t=await fetch("/drone-parts/index.json");if(t.ok)return e=await t.json(),e;throw Error()},l=`
.drones-app {
  background: var(--color-bg);
  border-top: 1px solid var(--color-border);
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  height: calc(100vh - var(--titlebar-height));
  right: 0;
  position: fixed;
  top: var(--titlebar-height);
  transition-duration: 200ms;
  transition-property: width;
  width: 300px;
  z-index: 100;
}

@media screen and (min-width: 800px) {
  .drones-app {
    position: sticky;
    left: 0;
    right: auto;
  }
}

.drones-app.closed {
  width: 1.5rem;
}

.opener {
  background-color: var(--color-accent);
  box-sizing: border-box;
  color: var(--color-dark);
  cursor: pointer;
  flex-shrink: 0;
  height: 1.5rem;
  line-height: 1.5rem;
  overflow: hidden;
  padding: 0 0.5em;
}

.drones-app__total,
.categories {
  box-sizing: border-box;
  opacity: 1;
  overflow: hidden;
  padding: var(--spacer);
  transition-duration: 200ms;
  transition-property: opacity;
  width: 300px;
}

.drones-app.closed .drones-app__total,
.drones-app.closed .categories {
  opacity: 0;
}

.drones-app__total {
  background-color: var(--color-accent);
  color: var(--color-dark);
  text-align: right;
}

.categories {
  overflow-x: hidden;
  overflow-y: scroll;
}

.category {
  display: flex;
  flex-direction: column;
}

.category__title {
  box-sizing: border-box;
  display: block;
  margin: var(--spacer-50) 0;
  padding: var(--spacer-50) 0;
}

.category > ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

.category > ul > li.item {
  align-items: center;
  display: flex;
}

.category > ul > li.item .item__amount {
  border: 1px solid var(--color-border);
  height: 1.5rem;
  line-height: 1.5rem;
  text-align: center;
  width: 1.5rem;
}

.category > ul > li.item .item__title {
  cursor: default;
  opacity: 0.2;
  padding: var(--spacer-50);
}

.category > ul > li.active .item__title {
  background-color: var(--color-paper);
  opacity: 1;
}
`,o=document.createElement("template"),i=()=>`
  <style>${l}</style>
  <div class="drones-app">
    <div class="opener">\u25E4 close</div>
    <div class="categories">Loading\u2026</div>
    <div class="drones-app__total">$ 0</div>
  </div>
`,a=({categories:t})=>`
  ${t.map(t=>`
  <div class="category">
    <h3 class="category__title" data-key="${t}">${t}</h3>
    <ul>
      ${e.filter(e=>e.Categories.includes(t)).map(e=>`
      <li class="item" data-key="${e.Key}">
        <div class="item__amount"></div>
        <div class="item__title">${e.Title}</div>
      </li>`).join("")}
    </ul>
  </div>
      `).join("")}
`,r=()=>{const n=[];return e.forEach(e=>{t.has(e.Key)&&n.push(e)}),n},c=class extends HTMLElement{openSidebar=()=>{const e=this.shadowRoot?.querySelector(".drones-app");if(!e)return;e.classList.remove("closed")};toggleSidebar=()=>{const e=this.shadowRoot?.querySelector(".drones-app");if(!e)return;e.classList.contains("closed")?e.classList.remove("closed"):e.classList.add("closed")};toggleItem=e=>{t.has(e)?t.delete(e):t.add(e),this.openSidebar(),this.update()};injectItems=()=>{const e=document.querySelector(".article__content");e?.querySelectorAll(".drone-item").forEach(t=>{const n=document.createElement("div"),e=document.createElement("button");e.innerText="Add",e.addEventListener("click",()=>{this.toggleItem(t.getAttribute("data-key")||"")}),n.appendChild(e),t.appendChild(n)})};update=()=>{this.shadowRoot?.querySelectorAll(".category > ul > li").forEach(e=>{const s=e.getAttribute("data-key")||"",n=e.querySelector(".item__amount");t.has(s)?(e.classList.add("active"),n&&(n.innerHTML="1")):(e.classList.remove("active"),n&&(n.innerHTML=""))});const e=this.shadowRoot?.querySelector(".drones-app__total");e&&(e.innerHTML=`$ ${r().reduce((e,t)=>e+ +t.Price,0).toLocaleString()}`)};constructor(){super();const e=o.content;this.attachShadow({mode:"open"}).appendChild(e.cloneNode(!0))}connectedCallback(){s().then(()=>{if(!this.shadowRoot)return;this.shadowRoot.innerHTML=i(),this.shadowRoot?.querySelector(".opener")?.addEventListener("click",()=>this.toggleSidebar());const t=new Set;e.forEach(e=>{e.Categories.forEach(e=>{t.add(e)})});const n=this.shadowRoot.querySelector(".categories");n&&(n.innerHTML=a({categories:[...t]})),this.injectItems(),this.shadowRoot.querySelectorAll(".category > ul > li.item").forEach(e=>{const t=e.getAttribute("data-key")||"",n=e.querySelector(".item__amount"),s=e.querySelector(".item__title");n?.addEventListener("click",()=>{this.toggleItem(t)}),s?.addEventListener("click",()=>{const e=document.querySelector(`.drone-item[data-key="${t}"]`);e&&e.scrollIntoView({behavior:"smooth"})})})})}};customElements.define("schaerweb-drones",c),n=document.createElement("schaerweb-drones"),document.querySelector("#app .paper")?.appendChild(n)})()